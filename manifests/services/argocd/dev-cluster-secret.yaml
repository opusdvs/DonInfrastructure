---
# Secret для добавления dev кластера в Argo CD
#
# ВАЖНО: Перед применением заполните значения:
#   - server: адрес API сервера dev кластера
#   - bearerToken: токен для аутентификации
#   - caData: CA сертификат dev кластера (base64)
#
# Получение значений:
#   # Адрес API сервера
#   kubectl config view --kubeconfig=$HOME/kubeconfig-dev-cluster.yaml --raw --minify -o jsonpath='{.clusters[].cluster.server}'
#
#   # CA сертификат (base64)
#   kubectl config view --kubeconfig=$HOME/kubeconfig-dev-cluster.yaml --raw --minify -o jsonpath='{.clusters[].cluster.certificate-authority-data}'
#
#   # Токен (если есть в kubeconfig)
#   kubectl config view --kubeconfig=$HOME/kubeconfig-dev-cluster.yaml --raw --minify -o jsonpath='{.users[].user.token}'
#
# Использование:
#   kubectl apply -f manifests/services/argocd/dev-cluster-secret.yaml
#
# Проверка:
#   kubectl get secret dev-cluster-secret -n argocd
#   # В Argo CD: Settings → Clusters → dev-cluster
apiVersion: v1
kind: Secret
metadata:
  name: dev-cluster-secret
  namespace: argocd
  labels:
    argocd.argoproj.io/secret-type: cluster
type: Opaque
stringData:
  name: dev-cluster
  # Адрес API сервера dev кластера (заменить на реальный)
  server: "https://85.193.90.217:6443"
  # Конфигурация подключения в формате JSON
  config: |
    {
      "bearerToken": "",
      "tlsClientConfig": {
        "insecure": false,
        "caData": ""
      }
    }
