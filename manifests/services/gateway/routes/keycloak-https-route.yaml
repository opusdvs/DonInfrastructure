---
# HTTPRoute для Keycloak на HTTPS listener
# Проксирует HTTPS трафик к сервису Keycloak
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: keycloak-server
  namespace: keycloak  # Измените namespace, если Keycloak установлен в другом namespace (например, default)
spec:
  hostnames:
    - "keycloak.buildbyte.ru"
  parentRefs:
    - name: service-gateway
      namespace: default
      sectionName: https-keycloak  # HTTPS listener для Keycloak
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: keycloak-service  # Имя сервиса, созданного Keycloak Operator
          port: 8080  # Порт Keycloak (по умолчанию 8080)
          weight: 1
